#!/bin/sh

# Comment by PM, 
# Wed Aug 26 12:26:48 UTC 2015
# 
# This script uses the $MONGO_PORT_27017_TCP_ADDR system variable, in order to
# determine the host you want to connect to
# This variable will be set in dockuro version 
# with the git revision e9df5f042aa923bc5f0e7069c2806b5b7a39d975
# and the latest containers you get, after an dockuro update

if [ $# -eq 0 ]
  then
    echo "example usage: ./mongo_export ../../sr_experimental_data/exp-2015-07-29_08-45-18"
  else
	MUH=`echo $1 | rev | cut -d'/' -f 1 | rev`
	GOAL="/home/suturo/catkin_ws/src/euroc/euroc_ml/logs"
	cp -r $1 $GOAL
	if ! [ $? -eq 0 ]; then
	    exit 0
	fi
	cd $GOAL/$MUH
	if ! [ $? -eq 0 ]; then
	    exit 0
	fi
	mongodump --host $MONGO_PORT_27017_TCP_ADDR --db $MUH --collection logged_designators 
	mongodump --host $MONGO_PORT_27017_TCP_ADDR --db $MUH --collection system.indexes 
	mongodump --host $MONGO_PORT_27017_TCP_ADDR --db $MUH --collection tf 
fi
